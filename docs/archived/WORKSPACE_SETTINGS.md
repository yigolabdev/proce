# Proce 워크스페이스 설정 (/org/setup)

## 📋 개요

관리자가 워크스페이스의 조직 프로필, 부서, 별칭/공정성 정책, RBAC 역할, 로캘/근무시간, 데이터 보존/프라이버시, 의사결정 기본값을 설정하는 종합 설정 페이지입니다.

---

## 🎯 주요 기능

### 6개 탭 구성

1. **조직 정보** - 워크스페이스 기본 정보
2. **부서·역할** - 부서 관리 및 RBAC 설정
3. **별칭·공정성** - 편견 방지 시스템
4. **로캘·근무시간** - 언어, 시간대, 근무 일정
5. **프라이버시·보존** - 데이터 보존 및 개인정보
6. **의사결정 기본값** - AI 의사결정 설정

---

## 📍 Tab 1: 조직 정보

### 입력 필드
- ✅ 워크스페이스 이름 (필수)
- ✅ 법인명 (선택)
- ✅ 이메일 도메인 (필수, 쉼표로 구분)
- ✅ 산업 (선택)
- ✅ 설명 (선택)
- ✅ 관리자 연락처 (필수)

### 특징
- 온보딩에서 가져온 데이터 표시 (배지)
- 이메일 도메인 자동 정규화 (소문자, 트림)
- 실시간 검증

---

## 📍 Tab 2: 부서 및 역할

### 부서 관리
- ✅ 부서 추가/제거
- ✅ 기본 접수 부서 지정 (1개 필수)
- ✅ 시각적 표시 (체크마크)

### RBAC 역할 (MVP)

| 역할 | 이슈 생성 | 승인 | 정책 편집 | 감사 조회 | 범위 |
|------|----------|------|----------|----------|------|
| **관리자** | ✅ | ✅ | ✅ | ✅ | 조직 (고정) |
| **매니저** | ✅ | ✅ | ❌ | ✅ | 조직/팀 (선택 가능) |
| **멤버** | ✅ | ❌ | ❌ | ❌ | 본인 (고정) |

### 특징
- 매니저 범위만 변경 가능 (조직/팀)
- 나머지 권한은 MVP에서 읽기 전용
- 테이블 형식으로 명확한 권한 표시

---

## 📍 Tab 3: 별칭 및 공정성

### 별칭 시스템
- ✅ 별칭 모드 활성화/비활성화
- ✅ 별칭 형식 선택:
  - `Alias-####` (숫자)
  - `Nova-####` (접두사+숫자)
  - `Word-Word` (중립적 단어 조합)
- ✅ UI에서 실명 숨기기

### 편견 방지 가드레일
- ✅ 피드백 스레드에서 직함/부서 숨기기
- ✅ 중립적 톤 레이블 사용
- ✅ 투표자에게 신뢰도 배지 숨기기

### 실시간 미리보기
- 선택한 별칭 형식으로 댓글 미리보기
- 가드레일 적용 상태 확인

---

## 📍 Tab 4: 로캘 및 근무시간

### 로캘 설정
- ✅ 기본 언어 (한국어/English)
- ✅ 시간대 (주요 시간대 제공)

### 근무 일정
- ✅ 근무일 선택 (월-일)
- ✅ 근무 시간 (시작/종료)
- ✅ 회사 휴일 관리 (추가/제거)
- ✅ 알림 조용 시간 (선택)

### 검증
- 시작 시간 < 종료 시간
- 최소 1개 근무일 필수

---

## 📍 Tab 5: 프라이버시 및 보존

### 데이터 보존 기간
- ✅ 활동 로그: 3/6/12/24개월
- ✅ 첨부파일: 3/6/12/24개월

### 내보내기 및 삭제 제어
- ✅ 사용자 자가 내보내기 허용 (JSON)
- ✅ 자가 삭제 요청 허용 (관리자 승인)

### 개인정보 처리
- ✅ 개인정보 포함 여부 체크
- ✅ PII 포함 시 DLP 안내 표시

### 감사 로그 가시성
- ✅ 관리자만
- ✅ 관리자 + 매니저

---

## 📍 Tab 6: 의사결정 기본값

### 의사결정 모드
- ✅ 하이브리드 (AI + 사람) - 기본값
- ✅ AI 전용
- ✅ 사람 전용

### 정책 옵션
- ✅ 증거 필수
- ✅ 신뢰도 표시
- ✅ 낮은 위험 자동 승인
- ✅ 에스컬레이션 대기 시간 (4h/8h/24h)

### Policy DSL 미리보기
- 현재 설정 기반 정책 코드 표시
- 읽기 전용

---

## 🎨 UI/UX 특징

### 전역 기능
- ✅ Sticky 헤더 (저장/초기화 버튼)
- ✅ 저장하지 않은 변경사항 경고
- ✅ 탭 네비게이션
- ✅ 실시간 검증
- ✅ Toast 알림

### 접근성
- ✅ 키보드 네비게이션
- ✅ ARIA 레이블
- ✅ 포커스 링
- ✅ 에러 메시지 (role="alert")

### 반응형
- ✅ 모바일 우선 디자인
- ✅ 탭 가로 스크롤 (모바일)
- ✅ 그리드 레이아웃 (데스크톱)

---

## 🔧 기술 구현

### 데이터 관리
- **저장소**: localStorage (`uniflow.settings`)
- **검증**: Zod 스키마
- **상태**: 로컬 state (페이지 내)
- **Context**: SettingsContext (선택적 사용)

### Mock API
```typescript
loadSettings()      // localStorage에서 로드
saveSettings(data)  // localStorage에 저장
getDefaultSettings() // 기본값 반환
```

### 파일 구조
```
frontend/src/app/org/setup/
├── page.tsx                    # 메인 페이지
├── _types/settings.types.ts    # TypeScript 타입
├── _schemas/settings.schema.ts # Zod 스키마
├── _i18n/settings.i18n.ts     # 다국어 (ko/en)
├── _mocks/settingsApi.ts      # Mock API
└── _components/
    ├── Tab1Organization.tsx    # 탭 1
    ├── Tab2DeptRole.tsx        # 탭 2
    ├── Tab3Alias.tsx           # 탭 3
    ├── Tab4Locale.tsx          # 탭 4
    ├── Tab5Privacy.tsx         # 탭 5
    └── Tab6Decision.tsx        # 탭 6
```

---

## 📊 데이터 구조

### WorkspaceSettings
```typescript
{
  org: OrgSettings,
  deptRole: DeptRoleSettings,
  alias: AliasSettings,
  locale: LocaleSettings,
  privacy: PrivacySettings,
  decision: DecisionDefaultsSettings
}
```

### 주요 타입
- `Industry`: 11개 산업 분류
- `AliasFormat`: 3가지 별칭 형식
- `DecisionMode`: 3가지 의사결정 모드
- `RoleScope`: org/team/self
- `RetentionPeriod`: 3/6/12/24개월
- `EscalationWindow`: 4h/8h/24h

---

## 🚀 사용 방법

### 1. 페이지 접근
```
http://localhost:5173/org/setup
```

### 2. 설정 변경
1. 원하는 탭 선택
2. 필드 수정
3. "저장" 버튼 클릭

### 3. 초기화
1. "기본값으로 초기화" 버튼 클릭
2. 확인 대화상자에서 승인

### 4. 저장하지 않은 변경사항
- 헤더에 경고 메시지 표시
- 페이지 이탈 시 브라우저 경고

---

## ✅ 검증 규칙

### 필수 필드
- 워크스페이스 이름 (최소 2자)
- 이메일 도메인 (최소 1개)
- 관리자 연락처 (이메일 형식)
- 부서 (최소 1개)
- 기본 접수 부서 (정확히 1개)
- 근무일 (최소 1개)

### 조건부 검증
- 근무 시간: 시작 < 종료
- 이메일: RFC 5322 형식
- 도메인: 최소 3자

---

## 🎯 다음 단계

### 백엔드 연동
1. REST API 엔드포인트 구현
2. 인증/인가 추가
3. 데이터베이스 스키마 설계

### 고급 기능
1. 부서 순서 변경 (드래그 앤 드롭)
2. 커스텀 역할 생성
3. 정책 DSL 편집기
4. 설정 히스토리 (버전 관리)
5. 팀별 설정 오버라이드

### 통합
1. 온보딩 데이터 자동 가져오기
2. 다른 페이지에서 설정 참조
3. 실시간 동기화 (WebSocket)

---

## 📝 참고사항

- MVP에서는 대부분의 역할 권한이 읽기 전용
- 매니저 범위만 변경 가능 (조직/팀)
- 모든 데이터는 localStorage에 저장 (프론트엔드 전용)
- 실제 배포 시 백엔드 API 필요

---

## 🌐 접근 경로

- **URL**: http://localhost:5173/org/setup
- **QuickNav**: "Workspace" 버튼
- **레이아웃**: AppLayout (헤더 + 사이드바 포함)

---

완성! 🎉

